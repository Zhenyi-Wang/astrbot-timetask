# AstrBot Timetask 定时任务插件

由COW插件[timetask](https://github.com/haikerapples/timetask)启发而来，为了实现定时发送任务到群聊。群聊功能暂时只支持WechatPadPro渠道。

与AstroBot自带的定时插件不同，不是通过LLM工具调用的形式实现，而是通过控制命令实现任务的添加，格式如下：

```
# 创建
/time <时间> [GPT] <消息内容> [group[群名]]

# 删除
/time rm <任务ID> [任务ID...]

# 列出所有定时任务
/time ls

# 显示帮助
/time help
```


## 示例

### 基本使用

```
# 每天早上8点问候
/time 每天 08:00 早上好！

# 工作日上午9点提醒
/time 工作日 09:00 该上班了！

# 每周五下午5点30分提醒
/time 每周五 17:30 周末愉快！
```

### 使用 GPT

```
# 让AI用猫娘的语气说早安
/time 每天 08:30 GPT 用猫娘的语气说早上好

# 每周一早上发送励志语录
/time 每周一 09:00 GPT 说一句励志的话
```

### 群组消息
注：群组消息目前仅支持 WechatPadPro 平台，而且需要将群聊加到机器人微信号的联系人列表中。
可能也支持好友昵称，但是没试过。

```
# 每天上午10点在工作群发送提醒
/time 每天 10:00 开始今天的站会啦！ group[工作群]

# 每周五下午发送周末问候到亲友群
/time 每周五 17:00 周末愉快！ group[亲友群]

# 使用GPT在天气群发送天气预报
/time 每天 08:00 GPT 今天天气怎么样？ group[天气群]
```

### Cron 表达式

```
# 整点报时
/time cron[0 * * * *] 现在整点报时！

# 工作时间内每30分钟提醒一次
/time cron[*/30 9-18 * * 1-5] 起来活动一下吧！

# 每天中午12点发送午餐提醒
/time cron[0 12 * * *] 该吃午饭啦！
```

## 管理任务

### 查看所有任务

```
/time ls
```

### 删除任务

```
# 删除单个任务
/time rm 1234

# 删除多个任务
/time rm 1234 5678
```

### 定时任务语法

### 时间格式

1. **具体日期**
   - `2025-03-30 16:30` - 指定具体日期时间
   - `今天 16:00` - 今天的指定时间
   - `明天 10:00` - 明天的指定时间
   - `后天 20:00` - 后天的指定时间

2. **循环任务**
   - `每天 08:00` - 每天固定时间
   - `工作日 09:00` - 每个工作日的指定时间
   - `每周一 10:30` - 每周固定星期几的指定时间

3. **Cron 表达式**
   - `cron[0 * * * *]` - 每小时整点
   - `cron[0 9-18 * * 1-5]` - 工作日上午9点到下午6点每小时
   - `cron[0 12 * * *]` - 每天中午12点

## 功能特点

- 支持多种定时方式：具体日期、每天、每周几、工作日、cron 表达式
- 支持发送消息到个人或指定群聊
- 集成 GPT 功能，可以生成动态内容
- 支持查看和删除已设置的定时任务

### 消息内容

- 普通文本：直接输入要发送的消息内容
- 使用 GPT：在消息前添加 `GPT` 关键字，让 AI 生成内容

### 群组消息

在消息末尾添加 `group[群名]` 可以将消息发送到指定群聊。